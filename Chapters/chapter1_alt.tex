%!TEX root = ../template.tex
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% chapter1.tex
%% NOVA thesis document file
%%
%% Chapter with introduction
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\typeout{NT FILE chapter1.tex}%
\listoftodos


\chapter{Theoretical Introduction}\label{cha:introduction}
\todo{Falta introdução? Meter a conversa dos FP de 2008}
Throughout this thesis, different topics regarding Quantum Mechanics, Atomic Physics and spectroscopy will be approached, hence why a theoretical introduction is needed. In it, themes such as the characteristic X-rays of elements, the relativistic Dirac equation and \gls{QED} corrections and methods for solving the many-body problem will be discussed.


\section{Characteristic X-rays}

When subjected to a high energy beam of particles (usually photons or electrons), an element may go through the process of the ionization of inner-core electrons, which is followed by the emission of radiation of its own, in the form of X-rays and/or Auger electrons. The radiation emitted throughout this process presents well-defined energy values and thus provides a way to ascertain if an element is present in a sample under study. Due to this reason, these characteristic emissions are of an extremely high importance in a wide range of scientific areas.



When an atomic system is in a bound state, the electrons orbiting the nucleus are occupying fixed quantum states, defined by their principal atomic number, $n$, angular momentum, $l$, and spin, $s$. Electrons are also fermions, and thus must respect Pauli's exclusion principle, each occupying a single state, only occupied by that single electron.
 These quantum numbers provide information about each electron's wavefunction, and the collection of all the electrons' wavefunctions can be used in order to describe the whole system. When operating the Hamiltonian on this collection of wavefunctions, the atomic system's state's energy is obtained.
Besides all the occupied states, an infinite more number of possible eigenfunctions will compose that system's base.

\subsection{Ionization as a vacancy generator}

As previously mentioned, X-ray fluorescence spectroscopy has many uses and applications in a wide range of scientific areas. In this form of spectroscopy, the element at study, composed of a nucleus and $N$ orbiting electrons, is bombarded with radiation leading to the ionization of inner-shell electrons while leaving a vacancy in their place (Figure~\ref{fig:photoionization}).



\begin{figure}[h!]
    \centering
    \begin{tikzpicture}[
        >={Stealth[scale=2]},
        photon/.style={decorate,decoration={snake,post length=3mm}}
    ]
        \draw (0,0) -- (3,0) node[right]{Inner shell};
        \draw[fill=blue!50!white] (1,0) circle (0.25) node {$\uparrow$};
        \draw[fill=blue!50!white,dashed,opacity=0.5] (2,0) circle (0.25) node {$\downarrow$};
        \draw[->,photon](3.5,1) node[above right]{$h\nu$>E$_{\text{b}}$} -- (2.25,0.25);
    
        \draw[dashed] (0,3) -- (3,3);
        \draw[dashed,draw opacity=0.5] (0,3.1) -- (3,3.1) node[right]{Continuum};
        \draw[dashed,opacity=0.25] (0,3.2) -- (3,3.2);
        \draw[dashed,opacity=0.1] (0,3.3) -- (3,3.3);
        \draw[dashed,opacity=0.05] (0,3.4) -- (3,3.4);
        \draw[fill=blue!50!white] (2,3.5) circle (0.25) node at (2,4){E$_{\text{k}}\approx h\nu$-E$_{\text{b}}$};
        \draw[->] (2,0.3) -- (2,3.2);
    
        \draw[-Stealth] (-0.5,-1) -- (-0.5,4) node[anchor=south east]{E};
        \draw (-0.4,3) -- (-0.6,3) node[left]{0};
        \draw (-0.4,0) -- (-0.6,0) node[left]{-E$_{\text{b}}$};
    \end{tikzpicture}
    \caption{Photoionization.}\label{fig:photoionization}
\end{figure}

The atomic structure, now composed of $N-1$ electrons, will be left in an energetically unstable state, due to there being other possible lower energy states. This will lead to various processes of atomic relaxation, where the system will rearrange itself in order to find a lower energy configuration.

The main processes for this rearrangement are two competing decay paths: radiative relaxation, and Auger electron emission.


\begin{figure}[h!]
    \centering
    \begin{subfigure}{0.49\textwidth}
        \begin{tikzpicture}[
            >={Stealth[scale=2]},
            photon/.style={decorate,decoration={snake,post length=3mm}}
        ]
            \draw (0,0) -- (3,0) node[right]{Inner shell};
            \draw[fill=blue!50!white] (1,0) circle (0.25) node {$\uparrow$};
            \draw[fill=blue!50!white] (2,0) circle (0.25) node {$\downarrow$};
            \draw[->,photon](2.25,0.25)  --  (3.5,1)node[above right]{$h\nu$=E$_{\text{b}_1}$-E$_{\text{b}_2}$};
        
            \draw[dashed] (0,3) -- (3,3);
            \draw[dashed,draw opacity=0.5] (0,3.1) -- (3,3.1) node[right]{Continuum};
            \draw[dashed,opacity=0.25] (0,3.2) -- (3,3.2);
            \draw[dashed,opacity=0.1] (0,3.3) -- (3,3.3);
            \draw[dashed,opacity=0.05] (0,3.4) -- (3,3.4);
            \draw[->] (2,1.7) -- (2,0.3);

            \draw (0,2) -- (3,2) node[right]{Upper level};
            \draw[fill=blue!50!white,dashed,opacity=0.5] (2,2) circle (0.25);



            \draw[-Stealth] (-0.5,-1) -- (-0.5,4) node[anchor=south east]{E};
            \draw (-0.4,3) -- (-0.6,3) node[left]{0};
            \draw (-0.4,0) -- (-0.6,0) node[left]{-E$_{\text{b}_1}$};
            \draw (-0.4,2) -- (-0.6,2) node[left]{-E$_{\text{b}_2}$};
        \end{tikzpicture}
        \caption{Radiative Decay}
    \end{subfigure}
    \begin{subfigure}{0.49\textwidth}
        \begin{tikzpicture}[
            >={Stealth[scale=2]},
            photon/.style={decorate,decoration={snake,post length=3mm}}
        ]
            \draw (0,0) -- (3,0) node[right]{Inner shell};
            \draw (0.5,1.5) -- (1.5,1.5);
            \draw[fill=blue!50!white] (1,0) circle (0.25) node {$\uparrow$};
            \draw[fill=blue!50!white] (2,0) circle (0.25) node {$\downarrow$};
            
            \draw[dashed] (0,3) -- (3,3);
            \draw[dashed,draw opacity=0.5] (0,3.1) -- (3,3.1) node[right]{Continuum};
            \draw[dashed,opacity=0.25] (0,3.2) -- (3,3.2);
            \draw[dashed,opacity=0.1] (0,3.3) -- (3,3.3);
            \draw[dashed,opacity=0.05] (0,3.4) -- (3,3.4);
            \draw[->] (2,1.7) -- (2,0.3);
            \draw[->] (1,1.8) -- (1,3.2);
    
            \draw (0,2) -- (3,2) node[right]{Upper level};
            \draw[fill=blue!50!white,dashed,opacity=0.5] (2,2) circle (0.25);
            \draw[fill=blue!50!white,dashed,opacity=0.5] (1,1.5) circle (0.25);
    
            \draw[fill=blue!50!white] (1,3.5) circle (0.25) node at (1.5,4){E$_{\text{k}}\approx E_{b_1}-E_{b_2}-E_{b_3}$};
    
            \draw[-Stealth] (-0.5,-1) -- (-0.5,4) node[anchor=south east]{E};
            \draw (-0.4,3) -- (-0.6,3) node[left]{0};
            \draw (-0.4,0) -- (-0.6,0) node[left]{-E$_{\text{b}_1}$};
            \draw (-0.4,2) -- (-0.6,2) node[left]{-E$_{\text{b}_2}$};
            \draw (-0.4,1.5) -- (-0.6,1.5) node[left]{-E$_{\text{b}_3}$};
        \end{tikzpicture}
        \caption{Auger Transition}
    \end{subfigure}
    \caption{Principal atomic relaxation processes.}
\end{figure}

In the case of radiative relaxation, an upper shell electron will move and occupy the hole left in the inner shell. During this process, energy is released through the emission of photons with energy in the range of X-rays. The detection of these photons is what allows for an analysis and detection of the element at study.

On the other hand, an Auger emission occurs when in the process of an upper electron shifting to a shell hole, energy is released not in the form of photons, but by the atomic system going through the process of the ionization of a lesser bound electron.


In reality, when the initial vacancy is generated, two more processes can occur: shake-off and shake-up. Due to a sudden change in the potential felt by the remaining electrons, whilst going through the ionization, one other electron may become unbound, leading to a second ionization, the shake-off process, or may be excited to an upper state, during shake-up. These processes' occurrence probabilities are related to the rate at which the electron leaves the system during the first ionization. For lower electron emission energies, where the ionization process is rather ``slow'', and there is not much energy for shake up/off to occur, the adiabatic regime reigns. In this regime, the shake probabilities are small, and increase with the beam's energy. For higher energies, the transition occurs in the sudden regime, where the electrons' exit can be considered instantaneous. Now, while the shake probabilities still increase with the energy of the beam, they quickly saturate for a maximum value of probability, which can be calculated by computing overlaps between the electrons' initial and final states. These processes, however, are out of scope for this thesis, but should the reader be interested, the model conceived by Thomas~\cite{Thomas_model} predicts the shake probability as a function of energy.\missingfigure{Maybe put a Thomas model plot?}

%Another explanation for these phenomena is the fact that, for example, during an ionization, the initial and final system do not possess the same set of eigenfunctions, due to the change of the number of electrons in the system. This means that, for example, an electron which did not take part in the ionization, and whose wavefunction is described by a set of quantum numbers, post-ionization can end up in a different state, defined by a different set, or even become unbound.

%These processes, however, will not be studied throughout this thesis, as the work in question focuses on excitation, where the energy of the incident radiation was not able to ionize the system, as will be later on explained in Section~\ref{sec:exc}.


\subsection{Transition notation}

The characteristic radiation measured from the radiative relaxation of a post-ionization unstable atomic system is one of the main ways of identifying an atomic element. This is due to the photons emitted possessing quantized values of energy, forming well-defined energy lines when observed in a spectrometer. In order to understand the change that occurred in the atomic system which lead to a specific emission, the spectral lines get labels based on a notation which usually takes into account the initial and final orbitals where the vacancy was present.
A very illustrative diagram, exemplifying some transitions can be found in Appendix~\ref{ap:trans}.

Throughout this thesis, Siegbahn notation will be used, for the most part, but should the reader prefer
IUPAC's, Table~\ref{tab:siegIUPAC} has the conversion between notations.

\begin{table}[h!]
    \centering
    \caption{Siegbahn VS IUPAC notation. Adapted from \cite{Vitha2015}.}\label{tab:siegIUPAC}
    \rowcolors{1}{}{GhostWhite}
    \begin{tabular}{cl |cl | cl}
        \toprule Siegbahn &IUPAC&Siegbahn &IUPAC&Siegbahn &IUPAC\\
        \midrule
        $K_{\alpha_1}$& $K-L_3$&$L_{\alpha_1}$&$L_3 - M_5$&$L_{\gamma_1}$&$L_2 - N_4$ \\
        $K_{\alpha_2}$&$K-L_2$&$L_{\alpha_2}$&$L_3 - M_4$&$L_{\gamma_2}$&$L_1 - N_1$ \\
        $K_{\beta_1}$&$K-M_3$&$L_{\beta_1}$&$L_2 - M_4$&$L_{\gamma_3}$&$L_1 - N_2$ \\
        $K_{\beta_2}^{I}$&$K-N_3$&$L_{\beta_2}$&$L_3 - N_5$&$L_{\gamma_4}$&$L_1 - O_3$ \\
        $K_{\beta_2}^{II}$&$K-N_2$&$L_{\beta_3}$&$L_1 - M_3$&$L_{\gamma_4^{'}}$&$L_1 - O_2$ \\
        $K_{\beta_3}$&$K-M_2$&$L_{\beta_4}$&$L_1 - M_2$&$L_{\gamma_5}$&$L_2 - N_1$ \\
        $K_{\beta_4}^{I}$&$K-N_5$&$L_{\beta_5}$&$L_3 - O_{4,5}$&$L_{\gamma_5}$&$L_2 - O_4$ \\
        $K_{\beta_4}^{II}$&$K-N_4$&$L_{\beta_6}$&$L_3 - N_1$&$L_{\gamma_8}$&$L_2 - O_1$ \\
        $K_{\beta_4}^{x}$&$K-N_4$&$L_{\beta_7}$&$L_3 - O_1$&$L_{\gamma_8^{'}}$&$L_2 - N_{5,6}$ \\
        $K_{\beta_5}^{I}$&$K-M_5$&$L_{\beta_8}$&$L_3 - N_{6,7}$&$L_{\eta}$&$L_2 - M_1$ \\
        $K_{\beta_4}^{II}$&$K-M_4$&$L_{\beta_9}$&$L_1 - M_5$&$L_{l}$&$L_3 - M_1$ \\
        &&$L_{\beta_9}$&$L_1 - M_4$&$L_{s}$&$L_3 - M_3$\\
        &&$L_{\beta_9}$&$L_3 - N_4$&$L_{t}$&$L_3 - M_2$\\
        &&$L_{\beta_9}$&$L_2 - M_3$&$L_{u}$&$L_3 - N_{6,7}$\\
        &&&&  $L_{v}$&$L_2 - N_{6,7}$\\ \bottomrule
    \end{tabular}
\end{table}

\subsection{Excitation as a vacancy generator}\label{sec:exc}

As previously mentioned, throughout this thesis, while the study is focused on the characteristic radiation emitted during an atomic relaxation process, the main vacancy generation method at study shall be the photoexcitation process (Figure~\ref{fig:exc}), instead of ionization. The levels obtained after a photoexcitation of core shell electrons has occurred could be some of the many so-called satellite states, where the electronic configuration present during the relaxation process contains additional electrons or holes, or is simply not the standard configuration when talking about characteristic emissions.
The characteristic radiation from transitions that originated from these states are one of the keys needed to fully comprehend and deconvolute an element's emission spectra.


\begin{figure}[h!]
    \centering
    \begin{tikzpicture}[
        >={Stealth[scale=2]},
        photon/.style={decorate,decoration={snake,post length=3mm}}
    ]
        \draw (0,0) -- (3,0) node[right]{Inner shell};
        \draw[fill=blue!50!white] (1,0) circle (0.25) node {$\uparrow$};
        \draw[fill=blue!50!white,dashed,opacity=0.5] (2,0) circle (0.25) node {$\downarrow$};
        \draw[->,photon](3.5,1) node[above right]{$h\nu$=E$_{\text{b}_1}$-E$_{\text{b}_2}$} -- (2.25,0.25);
    
        \draw[dashed] (0,3) -- (3,3);
        \draw[dashed,draw opacity=0.5] (0,3.1) -- (3,3.1) node[right]{Continuum};
        \draw[dashed,opacity=0.25] (0,3.2) -- (3,3.2);
        \draw[dashed,opacity=0.1] (0,3.3) -- (3,3.3);
        \draw[dashed,opacity=0.05] (0,3.4) -- (3,3.4);
        \draw[->] (2,0.3) -- (2,1.7);

        \draw (0,2) -- (3,2) node[right]{Upper level};
        \draw[fill=blue!50!white] (2,2) circle (0.25);



        \draw[-Stealth] (-0.5,-1) -- (-0.5,4) node[anchor=south east]{E};
        \draw (-0.4,3) -- (-0.6,3) node[left]{0};
        \draw (-0.4,0) -- (-0.6,0) node[left]{-E$_{\text{b}_1}$};
        \draw (-0.4,2) -- (-0.6,2) node[left]{-E$_{\text{b}_2}$};
    \end{tikzpicture}
    \caption{Resonant Photoexcitation}\label{fig:exc}
\end{figure}

\section{Radiative transitions}



In terms of quantum mechanics, the properties of a system's change of state can be derived using perturbation theory, where a change in energy can be treated as perturbation, and takes into account the conservation laws physical properties, such as the angular momentum of the system as basis for the selection rules.

The transition's radiation type can be of two main flavors, Electric, $E_k$, or Magnetic, $M_k$, with $k$ representing its multiplicity. These labels indicate which of the \gls{EMF} component had the strongest influence on the transition's occurrence.
For both these types of transitions, the system's total angular momentum is allowed a change of $\Delta J = 0, \pm k$, and so does its projection, $M_J$. However, different transitions lead to different changes of parity in the system and to different selection rules.

It should also be of note that, usually, for the same multiplicity, an $E$ transition is more intense than an $M$, and that it is also possible for rare 2-photon transitions to take place, where a combination of different transition types can occur.



The intensity of a transition is proportional to the squared norm of the perturbation's matrix element involving the initial and final state $\qty(\Gamma_{if}\propto \qty|\mel**{\psi_i}{H'}{\psi_f}|^2)$. It should also be noted that the electron's initial state population will serve as a scaling factor for the transitions' rate.
For example, while the transition rate for a $2p_{1/2}\rightarrow1s$ and $2p_{3/2}\rightarrow1s$ should be about the same, the orbital $2p_{3/2}$ has double the population $2p_{1/2}$ has, hence why the $K_{\alpha_2}$ line has about half the $K_{\alpha_1}$ line's intensity.

One should also mention that monochromatic transitions do not exist. While the transition might have a well-defined energy, calculated by the difference in energy between the initial and final levels, due to Heisenberg's uncertainty principle, $\Delta E \Delta t > \frac{\hbar}{2}$, there will exist a natural energy broadening, the transition's natural width. The shapes representing these transitions are given by a Lorentzian distribution.




\section{Solving the atomic many-body problem}

When studying a system composed of multiple charged bodies, one must consider all the existing interactions. Whilst there are known analytical solutions for 2-bodies Hydrogenoid systems, with the presence of more non spatially-bound particles, the Coulomb interaction pairs lead to the impossibility of finding a set of analytical wavefunctions which are a part of the Hamiltonian's eigenset. Consecutively, the need for a numerical method that is able to compute solutions for these complex systems arose.

\subsection{The non-relativistic Hamiltonian}

The first approach used in order to solve the many-bodies problem used a non-relativistic consideration. This way, the Hamiltonian consists on the sum of the system's non-relativistic momentum-related energies and the energy of Coulomb interactions between all the bodies in the system, while considering the nucleus as fixed in space, due to it being thousands of times more massive than the orbiting electrons.

Essentially, and in atomic units:




\begin{equation}
    \begin{gathered}
        \underbrace{\sum_i^N \overbrace{ \dfrac{1}{2}\laplacian_i}^{E_1}  \overbrace{-\frac{Z}{r_i}}^{E_2}}_{\text{Individual Hamiltonian}}  + \underbrace{\sum_{i<j}^{j}\overbrace{\dfrac{1}{r_{ij}}}^{E_3}}_{\text{Pair repulsion}},\\
        E_1\rightarrow\text{Momentum}\quad E_2\rightarrow\text{e$^-$nuc. Coulomb attraction}\quad E_3\rightarrow\text{e$^-$e$^-$ Coulomb repulsion}
    \end{gathered}
    \label{eq:nonRelHam}
\end{equation}



\subsection{The Hartree-Fock Method}\label{sec:HF}

This numerical method is one of the staple and most enduring procedures for solving the problem associated with a many-body system. As a side note, an in-depth explanation on all the intricacies of this method can be found in many of the literature, but as for the writing of this thesis, the works~\cite{HFweb,JPS,Ramon,Blinder2018} were the ones consulted.

Hartree developed an iterative method, further enhanced by Fock and Slater, based on the field's \gls{selfconsistency}. In this approach, when studying a multi-electronic system, such as an atom, each electron's wavefuction is composed as a product of a spacial part, $\psi$, and one related to the electron's spin, $\chi$, as to be able to account for Pauli's exclusion principle and, if so desired, relativistic effects.

\begin{equation}
    u=\psi\chi,
\end{equation}

The wavefuction capable of describing the whole system, $\Psi$, should be somewhat of a product of all the wavefunctions describing each individual electron. However, one must not forget the need for this wavefunction to respect the antisymmetry principle\todo{Explain antisymmetry and put it in the glossary}, due to the electron's fermionic nature. In order to achieve this, $\Psi$ is to be composed of a Slater determinant:\todo{Explain in the glossary}

\begin{equation}
    \Psi=\frac{1}{\sqrt{N!}}\mqty| u_1(x_1) & u_2(x_1) & \cdots & u_N(x_1)\\
    u_1(x_2) & u_2(x_2) & \cdots & u_N(x_2)\\
    \vdots & \vdots& \ddots&\vdots\\
    u_1(x_N)&u_2(x_N)&\cdots&u_N(x_N)&|,
\end{equation}

It is of high importance that the set of basis wavefunctions respects orthonormality. These are to be initialized as trial wavefunctions for the numerical method. 


The main goal for this algorithm is to, as per the \gls{selfconsistency}, follow the variational principle with the goal of minimize a functional, as a way of reaching an energetic minimum. This optimal, yet unknown energy, $E_0$ (calculated by operating the Hamiltonian on the system's optimal wavefunctions), will attempt to be reached by the variation  of the trial wavefunctions that provide a non-minimized solution. Whilst the optimal wavefunctions will never be reached, the purpose of this method is to reach a solution that yields an energetic value as close as possible to $E_0$, while always yielding $\ev**{H}{\Psi}\geq E_0$, due to the numerical nature of the method.

The computational method consists on starting with the previously mentioned trial wavefunctions and employing them in the Hartree-Fock's potential calculation through the \gls{HF} equations.\todo{Finish the explanation}


In an over-simplistic scheme, the self-consistent Hartree-Fock computational method can be represented by the block diagram in Figure~\ref{fig:diagram}.


\begin{figure}[h!]
    \centering
    \begin{tikzpicture}[node distance=2cm,every text node part/.style={align=center}]
        \node (initWF) [startstop] {Define Initial \\ Test Wavefunctions};
        \node (loadWF) [io, below of=initWF, yshift=-0cm] {Initial \\ Wavefunctions};
        \node (EnCalc1) [process,right of = loadWF,xshift= 2cm]{Compute \\ Energy ($E_i$)};
        \node (calcPotential) [process,below of= loadWF]{Compute density matrix \\ and HF potential};
        \node (calcWF) [process, below of = calcPotential]{Solve HF equations \\ for new potential};
        \node (newWF) [io, below of=calcWF] {New \\ Wavefunctions};
        \node (EnCalc2) [process,right of = newWF,xshift= 2cm]{Compute \\ Energy ($E_f$)};
        \node (EnComp) [decision,below of = newWF,yshift=-1cm]{$E_i-E_f\leq \lambda$?};
        \node (stop) [startstop,right of = EnComp,xshift=2cm] {End of \\ algorithm};

        \draw [arrowdiag] (initWF) -- (loadWF);
        \draw [arrowdiag] (loadWF) -- (EnCalc1);
        \draw [arrowdiag] (loadWF) -- (calcPotential);
        \draw [arrowdiag] (calcPotential) -- (calcWF);
        \draw [arrowdiag] (calcWF) -- (newWF);
        \draw [arrowdiag] (newWF) -- (EnCalc2);
        \draw [arrowdiag] (newWF) -- (EnComp);
        \node (aux1) [left of =EnComp,xshift=-2cm] {No};
        \node (aux2) [left of =loadWF,xshift=-2cm] {Load new WF \\ as initial WF};
        \draw (EnComp) -- (aux1);
        \draw (aux1) -- (aux2);
        \draw [arrowdiag] (aux2) -- (loadWF);
        \draw [arrowdiag] (EnComp) --node[anchor=south]{Yes} (stop);
    \end{tikzpicture}
    \caption{HF method's block diagram.}\label{fig:diagram}
\end{figure}





\subsection{The Dirac Equation}



While Schrödinger's equation may be one of the most significant and impactful equations in Modern Physics, it is also not free of its of limitations. The fact that it does not account for the existence of the electron's spin and the lack of consideration of relativistic effects are some of the most impactful setbacks. Consulting the works in~\cite{Thaller1992,Beyer2016,Sakurai2020,Bethe1977}, this work will follow an exploration of different approaches that followed in order to solve the aforementioned problem.


%------------------------------------------------------------------------------




Many scientists, such as Klein, Gordon and later Fock, had already conceived a relativistic correction to Schrödinger's equation, where the free-particle energy makes use of the relativistic momentum-energy relation,  as displayed in equation \eqref{eq:EnMomRel}.


 \begin{equation}
    E=\sqrt{c^2\vb*{p}^2+m^2c^4},
    \label{eq:EnMomRel}
 \end{equation}


 This notable definition can be derived from the \gls{lorentzinvariance} scalar produced by \gls{MinkNorm} of the momentum \gls{fourvec}~\eqref{eq:4mom}.


 \begin{equation}
    p^\mu p_\mu = m^2c^2\Leftrightarrow\dfrac{E^2}{c^2}-\vb*{p}^2=m^2c^2 \Leftrightarrow  \dfrac{E^2}{c^2}= \vb*{p}^2 +m^2c^2,
    \label{eq:4mom}
\end{equation}

 Now, inputting this new energy operator into Schrödinger's equation, yields the Klein-Gordon equation~\eqref{eq:KG}, allowing for Schrödinger's equation to now be Lorentz-invariant (proof can be found in Strickland's book~\cite{Strickland}).

 \begin{equation}
    -\hbar^2 \pdv[2]{t} \vb*{\psi}=\qty(-c^2\hbar^2\laplacian + m^2c^4)\vb*{\psi},
    \label{eq:KG}
\end{equation}



 This new approach was, however, still limited, as it only described spin 0 particles (e.g., some mesons), and made use of a second order derivative in the time-like component.\todo{Try to explain why this might be a problem}

Came 1928 and a new equation was developed by Paul Dirac~\cite{Dirac}, one taking now into account not the classical 3 dimensional space components, but the relativistic four components.




 Dirac started by rewriting the energy-momentum relation, ending up with an equivalent equation~\eqref{eq:diracEnergy}, employing $4\times 4$ matrices, due to the 4 relativistic dimensions at play, and incorporating spins into the equation by making use of the Pauli matrices~\eqref{eq:pauli}.

 \begin{equation}
    E=c\vb*{\alpha}\cdot \vb*{p}+{\beta} mc^2,\quad \vb*{\alpha}=\qty(\alpha_1,\alpha_2,\alpha_3),
    \label{eq:diracEnergy}
 \end{equation}

 \begin{align}
    \alpha_i&=\mqty(0 & {\sigma}_i\\ {\sigma}_i&0) & {\beta}&=\mqty(I_2 & 0 \\ 0 &-I_2) &I_2&=\mqty(1&0\\0&1),\\
    \sigma_1&=\mqty(0&1\\1&0) & \sigma_2&=\mqty(0&-i\\i&0)& \sigma_3&=\mqty(1&0\\0&-1),\label{eq:pauli}
 \end{align}

 In order to fully comprehend this shift of notation, one should equate the square of the two equations, \eqref{eq:EnMomRel} and~\eqref{eq:diracEnergy}, and confirm its validity.

 \begin{equation}
    c^2 \vb*{p}^2 + m^2c^4 = c^2\vb*{\alpha}^2\vb*{p}^2+2 m c^3 \vb*{\alpha}\cdot \vb*{p} \cdot \beta + \beta^2 m^2 c^4,
 \end{equation}

 In order for this equation to make sense, the following conditions must be true \sout{(which in fact, they are)}: \todo{do the demonstration, dummy}

\begin{gather}
    \begin{cases}
        c^2\vb*{p}^2=c^2\vb*{\alpha}^2 p^2  &\Leftrightarrow \vb*{\alpha}^2=1\\
        0=2mc^3  p \vb*{\alpha} \beta &\Leftrightarrow \vb*{\alpha} \beta =0\\
        m^2c^4=\beta^2 m^2c^4     &\Leftrightarrow \beta^2 =1
    \end{cases},
\end{gather}


Taking the previous considerations into account, one can now construct Dirac's free-particle equation~\eqref{eq:DiracEq}:

\begin{equation}
    i\hbar \pdv{t}\vb*{\psi}=\qty( c\vb*{\alpha}\cdot \vb*{p} +\beta m c^2)\vb*{\psi}=\mqty(mc^2 I_2& -i\hbar c \vb*{\sigma}\cdot \grad\\-i\hbar c \vb*{\sigma}\cdot \grad & -mc^2 I_2)\cdot \mqty(\psi_1\\\vdots\\\psi_4),
    \label{eq:DiracEq}
\end{equation}

This equation, however, as mentioned above, can only describe a single particle present in a field-free region. In order to account for the existence of a field, such as the electromagnetic field, derived from the four-potential $A^\mu$, composed by the electric scalar potential field, $A^0=\phi$, and the vector potential, $(A^1,A^2,A^3)=\vb*{A}$, the following change on the momentum four-vector must be made:


\begin{equation}
    p^\mu \rightarrow p^\mu - e A^\mu,\quad A^\mu = \qty(\phi,\vb*{A}),
\end{equation}

The Hamiltonian can now be rewritten as to account for the presence of the electromagnetic field~\eqref{eq:DiracEqField}. This way it is possible to include, for example, the electron-nucleus Coulomb attraction.

\begin{equation}
    H_D=-e\phi + \beta m c^2 + \vb*{\alpha}\qty(c\vb*{p}+e\vb*{A}),
    \label{eq:DiracEqField}
\end{equation}

For a central fixed potential, as is the one generated by the nuclear charge, the 3 space-like components from the four-potential are null, and the time-like component, $\phi=\dfrac{Z e}{r}$. The Hamiltonian gains now a more recognizable form:

\begin{equation}
    H_D=-\frac{e^2 Z}{r} + \beta m c^2 + \vb*{\alpha}\cdot\vb*{p}c,
    \label{eq:diracHam}
\end{equation}

A very interesting fact about Dirac's equation is that it yields, in fact, two sets of solutions: the large component (positive energy values), for particles, and the small component (negative energy values), for antiparticles.

\subsubsection{The Dirac-Breit Equation}

Once again, when considering a system composed of many bodies, one must consider all the present interactions, namely, the electron-electron repulsion in an atom.
 Breit, in 1929, had created a relativistic approach to treat the electron-electron interactions, consisting on a set of equations building upon the classical non-relativistic Hamiltonian from equation~\eqref{eq:nonRelHam}, which can be consulted in Appendix~\ref{ap:Breit}.
  Breit's equations are able to account for angular momenta couplings and estimate level energy splittings, the change of a particle's apparent mass as a function of velocity, and even include the interaction of an applied external magnetic field~\cite{Bethe1977}.

  It is quite obvious Breit's equations introduce a great complexity in the search of the new Hamiltonian's eigenfunctions. Nonetheless, when trying to include an approximation of Breit's considerations into Dirac's equation, one must add the following operator to the one present in equation \eqref{eq:diracHam}:

  \begin{equation}
    H_B = \sum_{i>j}\frac{e^2}{r_{ij}} - e^2\qty(\frac{\vb*{\alpha}_i\vb*{\alpha}_j}{r_{ij}}+\frac{\qty(\vb*{\alpha}_i \grad_i)\qty(\vb*{\alpha}_j \grad_j)r_{ij}}{2})  ,
    \label{eq:BreitHam}
  \end{equation}

This set of terms will account for the fact that Coulomb interactions, mediated by the electric field, and therefore, \gls{virtual photons}, cannot occur at instantaneous velocities, but at the speed of light.


\section{\gls{QED} considerations}\todo{Falar aqui sobre as contribuições. Não tem que ser extensivo}


\textcolor{red}{Lorem ipsum dolor sit amet, consectetur adipiscing elit. Etiam ut justo justo. Cras pulvinar massa sollicitudin ligula faucibus, in vulputate magna viverra. Nulla risus ante, maximus ut nunc sit amet, condimentum convallis mi. Phasellus et mi aliquet, ornare sapien egestas, vehicula orci. Donec ac massa tempus, iaculis tortor vitae, tempus tortor. Donec nec justo eros. Sed mauris purus, facilisis eu tempus quis, mattis et erat. Sed et congue metus, in venenatis nibh. Nullam ipsum ex, scelerisque non nunc sit amet, ultrices commodo felis. Proin sodales turpis nulla, quis tincidunt leo auctor id. Ut ac nulla quis felis molestie ullamcorper. Nulla tristique dui velit, sit amet rutrum libero dignissim id.}

\textcolor{red}{In hac habitasse platea dictumst. Vivamus laoreet neque odio, vitae faucibus massa eleifend sit amet. Curabitur tempor facilisis velit, eget blandit nisi rutrum at. Morbi a massa a lacus lobortis ultricies eget vel enim. Ut augue nisl, tristique eget luctus eget, scelerisque vitae risus. Aliquam in felis et metus euismod porttitor. Nullam nec ligula mi. Aliquam non vulputate sem. Proin ut leo eget ex bibendum venenatis ac vel sapien. Cras felis eros, cursus quis dolor posuere, scelerisque tempus orci. In nec quam in dui efficitur aliquam vitae sit amet dui. Cras laoreet tellus vel risus molestie mattis. Nulla facilisi. Duis rutrum mauris vitae malesuada consequat.}


\begin{figure}[h!]
    \centering
    \begin{tikzpicture}[]
        \draw[-Stealth] (0,2.3) -- (0,9) node[anchor=east]{E};
        \draw (0,-2) -- (0,2);
        \draw (-0.25,1.75) -- (0.25,2.25);
        \draw (-0.25,2.05) -- (0.25,2.55);

        \draw (1,1)node[anchor=east]{n=1} -- (2.5,1);
        \draw (1,4)node[anchor=east]{n=2} -- (2.5,4);
        \draw (1,6)node[anchor=east]{n=3} -- (2.5,6);
        \draw (1,7) -- (2.5,7);
        \draw (1,7.5) -- (2.5,7.5);
        \draw (1,7.75) -- (2.5,7.75);
        \draw (1,7.75+0.125) -- (2.5,7.75+0.125);
        \draw (1,7.75+0.125+0.125/2) -- (2.5,7.75+0.125+0.125/2);
        \draw[fill=black] (1,7.75+0.125+0.125/2) rectangle (2.5,7.75+0.125+0.25);



        \draw (5,0) -- (6.5,0);
        \draw[dashed] (2.5,1) -- (5,0);
        \node at (4/2+5.5/2+1,0)[anchor=south] {$1S_{1/2}$};
        \draw (5,3.8) --(6.5,3.8);
        \draw[dashed] (2.5,4) -- (5,3.8);
        \draw (5,3.2) --(6.5,3.2);
        \draw[dashed] (2.5,4) -- (5,3.2);
        \node at (3+5.5/2,3.2)[anchor=north] {$2S_{1/2},\ 2P_{1/2}$};
        \node at (3+5.5/2,3.8)[anchor=south] {$2P_{3/2}$};
        \draw (5,5.9) -- (6.5,5.9);
        \draw[dashed] (2.5,6) -- (3,5.9);
        \draw (5,5.8) -- (6.5,5.8);
        \draw[dashed] (2.5,6) -- (5,5.8);
        \draw (5,5.65) -- (6.5,5.65);
        \draw[dashed] (2.5,6) -- (5,5.65);
        \node at (3+5.5/2,5.65) [anchor=north] {$3S_{1/2},\ 3P_{1/2}$} ;
        \draw (4.75,6.2)node[anchor=south]{$3P_{3/2}$} -- (5.5,5.8);
        \draw (6.75,6.2)node[anchor=south]{$3D_{3/2}$} -- (6,5.8);
        \draw (3+5.5/2,5.9) -- (3+5.5/2,6.5)node[anchor=south]{$3D_{5/2}$};

        \draw[dashed] (6.5,0) -- (9,0.3);
        \draw (9,0.3) -- (10.5,0.3);
        \node at (7/2+8.5/2+2,0.3)[anchor=south] {$1S_{1/2}$};
        \draw (9,3.2) -- (10.5,3.2);
        \node at (9/2+10.5/2,3.2)[anchor=north] {$2P_{1/2}$};
        \draw (9,3.3) -- (10.5,3.3);
        \draw[dashed] (6.5,3.2) --(9,3.3);
        \draw[dashed] (6.5,3.2) --(9,3.2);
        \node at (9/2+10.5/2,3.8)[anchor=south] {$2P_{3/2}$};
        \draw (9,3.8) -- (10.5,3.8);
        \draw[dashed] (6.5,3.8) --(9,3.8);
        \draw (10.0,3.3) -- (10.75,3.7)node[anchor=west] {$2P_{3/2}$};

        \draw (9,5.65) -- (10.5,5.65);
        \draw[dashed] (5.5,5.65) -- (9,5.65);
        \draw (8.75,5.25)node[anchor=north]{$3P_{1/2}$} -- (9.5,5.65);
        \draw (9,5.63) -- (10.5,5.63);
        \draw (10.75,5.25)node[anchor=north]{$3S_{1/2}$} -- (10,5.65);
        \draw[dashed] (5.5,5.65) -- (9,5.63);
        \draw (9,5.8) -- (10.5,5.8);
        \draw[dashed] (5.5,5.8) -- (9,5.8);
        \draw (8.75,6.2)node[anchor=south]{$3P_{3/2}$} -- (9.5,5.8);
        \draw (9,5.9) -- (10.5,5.9);
        \draw (10.75,6.2)node[anchor=south]{$3D_{3/2}$} -- (10,5.8);
        \draw[dashed] (5.5,5.9) -- (9,5.9);
        \draw (4.5+10.5/2,5.9) -- (4.5+10.5/2,6.5)node[anchor=south]{$3D_{5/2}$};
        \node at  (0.5+2.5/2,-1) {Schrödinger's};
        \node at  (0.5+2.5/2,-1.5) {equation};

        \node at  (4/2+5.5/2+1,-1) {Dirac's};
        \node at  (4/2+5.5/2+1,-1.5) {equation};

        \node at  (4.5+10.5/2,-1) {QED};
        \node at  (4.5+10.5/2,-1.5) {contributions};


       % \draw (8.75,2.8)\node [anchor=north] {} --  (9.5,3.2);


    \end{tikzpicture}
    \caption{Comparison of Hydrogen level diagrams. Adapted from \cite{GSI_pres}}\label{fig:split}
\end{figure}

Should the atomic system be subjected to an external \gls{EMF}, the level structure would change due to Zeeman's and Stark's effects, allowing for the probing of the atom's hyperfine structure.


\subsection{The \gls{MCDF} Method}\todo{Ler bem o manual e explicar bem o método e todas as coisas diferentes que se podem fazer}

As previously mentioned in section~\ref{sec:HF}, there is a need for a numerical method in order to compute and find the eigenfunctions for a many-body Hamiltonian. While the Hartree-Fock method was able to reasonably solve the non-relativistic problem, now, while considering the Dirac-Breit Hamiltonian from equations \eqref{eq:diracHam} and \eqref{eq:BreitHam}, there is a need for a new method.

Hence, the state of the art \gls{MCDFGME} arises. This self-consistent iterative method, based on the same method present in section \ref{sec:HF}, is able to solve and find eigenfunctions for a multielectronic system, now taking into account the Dirac-Breit Hamiltonian. Moreover, it is also capable of incorporating electron correlation and many QED effects not yet considered in the relativistic equation, such as the Lamb-shift, vacuum polarization, and the electron's self energy.
A brief description of these contributions can be found in  appendix \ref{ap:QED}




\section{State of the Art}\todo{This really needs a re-do}


\subsection{Copper's characteristic X-rays}
Copper is a dominant element in today's society. While most of its uses are day-to-day related, it also has a high prevalence in many physical areas, namely, copper's $K_\alpha$ transitions~\cite{Nguyen2022}. While these radiative transitions have been measured countless times, with very well recorded energy values~\cite{Melia2020,Melia2019,Sorum1987,Bremer1982,Deutsch1995}.
It is also common knowledge Copper's $K_\alpha$ lines do not have a symmetric distribution, since both $K_{\alpha_1}$ and $K_{\alpha_2}$ line display a negative (left-tailed) skewness. Due to this fact, most of the fitting models used in order to analyze both Copper's $K_{\alpha_1}$ and $K_{\alpha_2}$ transitions involve the usage of a Lorentzian doublet, for each line~\cite{Ito2016,Berger1986}.
While many associate these asymmetries due to satellite states formed by shake processes~\cite{Galambosi2003,Nguyen2022}, with some theoretical studies having been performed~\cite{Chantler2009}, some authors note it could be due to X-ray resonant Raman scattering~\cite{Galambosi2003}. This effect occurs when a sample is exposed to energies under to near the ionization threshold, when a bound electron is excited to an upper state~\cite{RamanBook}.
While there are some studies exploring this topic, most are focused on the cascade of low energy transitions that follow the post-scattering excitation~\cite{Carra1995}. Nonetheless, a previous experimental study has been able to show that for Copper exposed to synchrotron radiation tuned to energies near K-shell's ionization energy, some $K_{\alpha_1}$ transitions demonstrated to be narrower than expected~\cite{Eisenberger1976}.








\subsection{MCDFGME capabilities}

It has been noted multiple times that \gls{MCDFGME} code excels in atomic structure calculations of super-heavy elements and highly-charged ions, where relativistic and QED effects are in prevalence \cite{Indelicato2011,Indelicato1987,Gorceix1987}. However, it has also been proven to be an excellent tool for the calculation of less ionized and lighter atomic systems \cite{Guerra2021}.

In addition, the \gls{MCDFGME} code is able to calculate radiative and auger transition rates for the calculated configurations, which can be used in the simulation of theoretical spectra, due to being able to compute the transition's intensity and natural width.
Since it is able to perform calculations, even for exotic atoms, it can be used to further understand many QED phenomena, further exploring the limits of our theory, and it's comparison to experimental data \cite{Paul2021}.

It should also be of note that there are many other code alternatives. While \gls{MCDFGME}, which is a close-source project, provides a very high precision in the performed calculations at a high computational cost, \gls{FAC}, is an open source code which requires less computational time for the calculations, however, it lacks \gls{MCDFGME}'s precision, since it only is able to consider all the spin-orb couplings, but does not mix the possible configurations originating them. 
It can, however, calculate other collisional processes, such as electronic impact excitation cross-sections~\cite{FAC}. \gls{GRASP2k}~\cite{GRASP2K}, and \textit{AUTOSTRUCTURE}~\cite{AUTOSTRUCTURE} are other codes with some of the same capabilities.


% \section{Methodology}\todo{Take this out}
% 
% As mentioned before, in this thesis, atomic relaxation transitions where the ejected inner shell electron, responsible for the generated hole, was not sent to the continuum, but excited to an upper state.
% 
% In order to use \gls{MCDFGME}, since it is written in FORTRAN, there will be a multitude of input/output files, with the extension \textit{.f0X}. The most important file extensions are \textit{.f05}, the input file, where the calculation settings are indicated; \textit{.f06}, where the energy results will be displayed, among others, such as some matrix element overlaps, both important to evaluate the convergence.
%  Other file extensions, such as \textit{.f09}, also store the final electrons' wavefunctions and can be quite useful for debugging processes, and for calculating other atomic parameters, such as shake probabilities, which will not be of relevance as of this thesis.
% 
%  An example of a normal atomic structure calculation for an excited Copper atom (which has a ground state configuration of $1s^2 2s^2 2p^6 3s^2 3p^6 3d^{10} 4s^1$) is as follows:
% 
%  One starts by choosing the excitation upper orbital, and by  writing in a text file all the possible 1 hole configurations from where the electron may have originated from. An example can be found in Annex~\ref{an:input}. This represents all the possible excited states where the electron is in the chosen orbital.
%  
%  The same process is now performed for a 2 hole configuration, where an additional ionization occurred. This represents the possible states after the occurrence of the Auger process, which is in competition with the radiative decay.
% 
%  Now, a \textit{bash} script, \textit{runMCDFEC.sh} is to be executed. Now, it will be possible to choose the atomic number of the element in study, the isotope mass, and, if one wishes so, to perform the calculations for an exotic atom, where, instead of electrons, other particles such as muons, negative hadrons and antiparticles can orbit the nucleus. 
%  The script will calculate all the possible spin-orbit couplings and eigenvalues, and then finally apply the \gls{MCDFGME} method.
% 
%  Depending on the excitation orbital, there will be thousands to tens of thousands of possibilities for the final configuration, with this number increasing with the quantum number of angular momentum, $l$, of the orbital.
%  
%  However, not all the calculations performed will automatically converge. Each time, a few hundreds of computed states will fail convergence. In a file, generated for the compilation of the calculation results, these states will be missing the total system's energy, or will display a significant energy difference for the results obtained by using two different methods, summing and integrating.
% 
%  The configurations that were not able to converge will now have to be converged by hand. In order to do this, their \textit{.f05} will have to be edited, where different methods will be chosen for the calculation for each specific orbital. As there are multiple possible methods and combinations, this step can take up to a few weeks to complete.
% 
%  After eliminating all the convergence problems, the radiative transition rates will be calculated, by operating the transition operator on all the possible 1 hole - 1 hole configuration pair combinations. The same will follow for all the pairs of 1 hole - 2 holes configurations, in order to compute the auger transition rates. Finally, the process is repeated for the 2 holes - 2 holes configurations, for the radiative transitions of the auger-generated satellite states.
% 
% 
%  Lastly, all the calculated transitions' widths will be summed in order to calculate each subshell's fluorescence yield (calculated by the sum of all radiative transition widths divided by the sum of all the radiative and non-radiative transition widths).
% 